
## Инструкции для взаимодействия с проектом

### О проекте
- Название: KataCut (`@katacut/cli`).
- Миссия: единый конфиг (`katacut.config.jsonc`) как «package.json для AI-инструментария» — раскладывает настройки MCP-серверов, IDE и других AI-агентов.
- Текущее состояние: CLI с командами `init` и `sync --dry-run`, ядро и адаптеры — заглушки.
- Стек: TypeScript/Node, pnpm монорепо, Biome, Vitest, `tsc -b`.
- Структура пакетов (упрощённо):
  - `packages/schema` — парсер/валидация конфига.
  - `packages/core` — доменная логика (план синхронизации).
  - `packages/cli` — команды и бинарь (`katacut`, `kc`).
  - `packages/utils-*` — FS, логирование, ошибки.
  - `packages/adapters/*` — будущие клиенты (Cursor, VS Code и т.п.).

- Всегда отвечать пользователю в чате на русском языке.
- Коммит-месседжи в этом проекте писать на английском языке.
- Формат коммитов — семантические префиксы (feat, fix, chore, docs, refactor и т.д.) плюс краткое описание.
- Коммиты: строго запрещены без прямого приказа пользователя. Команду `git commit` выполняй только после явного указания.
- Пуши: `git push` также выполняй только по отдельному явному приказу (даже если коммит уже сделан).
- Нет приказа — нет действия: без явной команды не исполняй `git commit`, `git push` и любые команды, изменяющие удалённый репозиторий.
### Работа с Git
- Любая команда `git` допускается только после прямого указания пользователя с конкретным действием (`git add`, `git commit`, `git push`, `git reset`, и т.п.). Общие формулировки не считаются.
- Если пользователь сказал «коммитим», собирай все актуальные изменения, формируй **однократный** коммит и сразу отчитывайся. После этого любые новые правки держи незакоммиченными, пока не получишь новое разрешение.
- Перед запуском команды сверяйся с `approval_policy`:
  - `on-request`, `on-failure`: обязательно запрашивай эскалацию; без подтверждения команда не должна выполняться.
  - `approval_policy=never`: эскалация недоступна, значит доступ уже повышен — выполняй команду напрямую, но только после явного приказа и сообщай результат.
- Сообщение «`index.lock`» в строгих политиках означает, что команда стартовала без подтверждения. Остановись и уточни у пользователя, как продолжать.
- Если git-команда выполнена по ошибке или без разрешения, немедленно сообщи и согласуй исправление.

- Всегда отвечать пользователю в чате на русском языке.
- Коммит-месседжи в этом проекте писать на английском языке.
- Комментарии в коде оставляй только по реальной необходимости и всегда на английском языке.
- Любой текст в файлах проекта пиши на английском языке, если пользователь не указал иное.
- Для линтинга используем только Biome; избегай `eslint-disable` и подобных директив.
- Внутри проекта не используй `null`. Для отсутствующих значений применяй `undefined`, за исключением явной необходимости на границах внешних API.

### Поиск свежей информации (очень важно)
- Темы MCP, AI-инструментов и агентов активно развиваются; не полагайся на память модели.
- Всегда используй интернет-поиск или официальные источники перед тем, как описывать или советовать что-либо по MCP/AI tooling.
- Если доступа к сети нет, явно указывай на это и не додумывай информацию.
- Для внешнего поиска используй только встроенный `web.run` (или `search`). Команды уровня `curl` для поиска запрещены.

### Цикл работы с кодом (важно)
- После любых изменений запускай `pnpm typecheck`.
- Пока есть хотя бы одна ошибка типов, продолжай исправлять код и снова гоняй `pnpm typecheck`.
- Останавливайся только когда проверка проходит без единой ошибки.

### Управление задачами
- Используем ручные карточки в каталоге `.tasks` (в репозитории не храним, каталог добавлен в `.gitignore`).
- Каждая задача — отдельный файл по шаблону из `docs/tasks-manual.md`.
- Перед стартом работы актуализируй список задач и статус вручную, синхронизируй прогресс в карточках.
- Новые инициативы сначала показывай в черновике (описание, приоритет, DoD). После одобрения создай карточку по шаблону и работай с ней.

### Принципы архитектуры и кода
- Следуй принципам SOLID, DRY, KISS, YAGNI, Clean Code. Избегай излишнего усложнения, но закладывай расширяемость.
- Реализуй только то, что нужно по текущей задаче; не добавляй функционала «на будущее» без согласования.
- Структура должна быть модульной: ядро без IO, адаптеры через явные интерфейсы, тестируемость — приоритет.
- Поддерживай высокий уровень читабельности и покрытие тестами; избегай дублирования и магических значений.
